%ul.block
  - nodes.each do |node|
    %li
      .node{ :style => "background-color:rgba(188,224,178,#{[ 1-level.to_f/10, 0.3 ].max});", :class => params[:id].to_i == node.id ? 'active' : '' }
        %a.create{:href => new_node_path(:parent_id => node.id)}><
          = image_tag("leaf_rails/add.png")
        %input{:name => "ids[]", :type => "checkbox", :value => node.id}/
        - if node.children.empty?
          .toggle{:style => "margin-left:#{15*level}px;"}><
        - else
          %button.no_styling.toggle.open{"data-id" => node.id, :type => "button", :style => "margin-left:#{15*level}px;"}>< Toggle
        %a.edit{:href => edit_node_path(node.id), :title => node.name, :style=> "left: #{43+15*level}px;"}><
          %img{:alt => "", :src => "http://miks.leaf.cubesystems.lv/xml_templates/language_root.png"}><
          %span= node.name
      - if !node.children.empty?
        = render 'tree_level', :nodes => node.children, :level => level + 1
