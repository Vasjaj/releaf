:ruby
  label_opts = get_template_label_options local_assigns
  input_opts = get_template_input_options local_assigns, {
    :accept => 'image/png,image/jpeg,image/bmp,image/gif'
  }

.field.type_text{ 'data-name' => name }
  - field_name = name.sub(/_uid$/, '')

  = render "edit.field_label", label_opts
  .value><
    = f.file_field field_name, input_opts
    - unless f.object.send(name).blank?
      .value_preview
        = f.hidden_field "retained_#{field_name}"
        - img_object = f.object.send(field_name)
        = link_to image_tag(img_object.thumb('x128>').url, :alt => ''), img_object.url, :target => :_blank, :data => {:lightbox => true }
  .clear
